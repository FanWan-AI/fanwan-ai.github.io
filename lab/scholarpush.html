<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title data-i18n="scholarpush_title">学术快报 - 每日精选论文推荐</title>
  <link rel="icon" href="../assets/logo.svg" type="image/svg+xml">
  <meta name="theme-color" content="#0ea5e9">
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; img-src 'self' data: https:; style-src 'self' 'unsafe-inline'; script-src 'self' 'unsafe-inline'; font-src 'self' data:; connect-src 'self'; base-uri 'self'; object-src 'none'">
  <meta name="referrer" content="no-referrer-when-downgrade">
  <meta name="description" content="学术快报 - 每日精选论文推荐" data-i18n-content="scholarpush_title">
  <link rel="canonical" href="https://fanwan-ai.github.io/lab/scholarpush.html">
  <meta property="og:type" content="website">
  <meta property="og:title" content="学术快报 - 每日精选论文推荐" data-i18n-content="scholarpush_title">
  <meta property="og:description" content="每日AI顶会/期刊论文精粹，一分钟掌握学术前沿。" data-i18n-content="module_scholarpush_desc">
  <meta property="og:image" content="https://fanwan-ai.github.io/assets/placeholder.jpg">
  <meta property="og:image:type" content="image/jpeg">
  <meta property="og:image:alt" content="ScholarPush cover">
  <meta property="og:url" content="https://fanwan-ai.github.io/lab/scholarpush.html">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="学术快报 - 每日精选论文推荐" data-i18n-content="scholarpush_title">
  <meta name="twitter:description" content="每日AI顶会/期刊论文精粹，一分钟掌握学术前沿。" data-i18n-content="module_scholarpush_desc">
  <meta name="twitter:image" content="https://fanwan-ai.github.io/assets/placeholder.jpg">
  <script>try{var L=localStorage.getItem('lang')||document.documentElement.lang||'zh';document.documentElement.setAttribute('lang',L);}catch(e){}</script>
  <link rel="stylesheet" href="../style.css">
  <script defer src="../lang.js"></script>
  <script defer src="../script.js"></script>
  <style>
    /* Single-column ScholarPush page */
    .sp-one{max-width:980px;margin:0 auto;padding:0 12px}
    .sp-toolbar{display:flex;gap:8px;flex-wrap:wrap;align-items:center}
    .sp-chiprow{display:flex;gap:8px;flex-wrap:wrap}
    .sp-section{margin:14px 0}
    .sp-card{padding:12px 14px}
    .sp-list{display:flex;flex-direction:column;gap:10px}
    .sp-meta{font-size:12px;color:var(--muted);display:flex;gap:6px;flex-wrap:wrap}
    .sp-title{font-size:16px;line-height:1.4;margin:0 0 6px 0}
  .sp-abstract{margin:0;color:var(--muted)}
    .stat-grid{display:grid;grid-template-columns:repeat(4,minmax(0,1fr));gap:10px}
    @media (max-width:700px){.stat-grid{grid-template-columns:repeat(2,minmax(0,1fr));}}
  </style>
</head>
<body class="blog">
  <a class="skip-link" href="#main">Skip to main content</a>
  <header>
    <nav class="navbar container">
      <a href="../index.html" class="brand" aria-label="Home">
        <img src="../assets/logo.svg" alt="Fan Wan logo" class="brand-logo" width="28" height="28" />
        <span class="logo"><span class="i18n l-zh">首页</span><span class="i18n l-en">Home</span><span class="i18n l-es">Inicio</span></span>
      </a>
      <ul class="nav-links">
        <li><a href="../index.html"><span class="icon" aria-hidden="true"><svg viewBox="0 0 24 24"><path d="M3 12l9-9 9 9"/><path d="M9 21V9h6v12"/></svg></span> <span class="i18n l-zh">首页</span><span class="i18n l-en">Home</span><span class="i18n l-es">Inicio</span></a></li>
        <li><a href="../about.html"><span class="i18n l-zh">关于我</span><span class="i18n l-en">About</span><span class="i18n l-es">Acerca de</span></a></li>
        <li><a href="../publications.html"><span class="i18n l-zh">学术出版物</span><span class="i18n l-en">Research</span><span class="i18n l-es">Investigación</span></a></li>
        <li><a href="../blog.html"><span class="i18n l-zh">博客</span><span class="i18n l-en">Blog</span><span class="i18n l-es">Blog</span></a></li>
  <li><a href="../ai-lab.html"><span class="i18n l-zh">AI Studio</span><span class="i18n l-en">AI Studio</span><span class="i18n l-es">Taller de IA</span></a></li>
        <li><a href="../contact.html"><span class="i18n l-zh">联系</span><span class="i18n l-en">Contact</span><span class="i18n l-es">Contacto</span></a></li>
      </ul>
      <div class="nav-actions">
        <div class="lang-switcher">
          <button id="lang-button" class="btn outline icon-btn" aria-haspopup="listbox" aria-expanded="false">
            <svg class="icon icon-globe" viewBox="0 0 24 24" aria-hidden="true"><g fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="9"/><path d="M3 12h18M12 3a15 15 0 0 1 0 18M12 3a15 15 0 0 0 0 18"/></g></svg>
            <span class="label"></span>
          </button>
          <ul id="lang-menu" class="lang-menu" role="listbox" aria-label="Language" hidden>
            <li role="option" data-lang="en">English</li>
            <li role="option" data-lang="zh">中文</li>
            <li role="option" data-lang="es">Español</li>
          </ul>
          <select id="lang-select" hidden>
            <option value="en">English</option>
            <option value="zh">中文</option>
            <option value="es">Español</option>
          </select>
        </div>
        <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme" title="Toggle theme">
          <svg class="icon icon-bulb" viewBox="0 0 24 24" aria-hidden="true">
            <g fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
              <path d="M9 18h6"/>
              <path d="M10 22h4"/>
              <path d="M8.5 15.5c-.9-1-1.5-2.3-1.5-3.8a5 5 0 1 1 10 0c0 1.5-.6 2.8-1.5 3.8-.6.7-1.1 1.4-1.3 2.2H9.8c-.2-.8-.7-1.5-1.3-2.2z"/>
              <path d="M12 2v2"/>
              <path d="M4 10h2"/>
              <path d="M18 10h2"/>
              <path d="M5.5 5.5l1.4 1.4"/>
              <path d="M18.5 5.5l-1.4 1.4"/>
            </g>
          </svg>
          <svg class="icon icon-moon" viewBox="0 0 24 24" aria-hidden="true"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/></svg>
          <svg class="icon icon-system" viewBox="0 0 24 24" aria-hidden="true"><g fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="12" rx="2" ry="2"/><path d="M8 20h8M12 16v4"/></g></svg>
        </button>
        <div class="hamburger" id="hamburger">
          <span></span><span></span><span></span>
        </div>
      </div>
    </nav>
  </header>

  <main id="main">
    <section class="page-hero section">
      <div class="bg-shapes">
        <span class="shape shape1"></span>
        <span class="shape shape2"></span>
        <span class="shape shape3"></span>
        <span class="shape shape4"></span>
      </div>
      <div class="container">
  <h1><span class="icon" aria-hidden="true"><svg viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><path d="M14 2v6h6"/><path d="M16 13H8"/><path d="M16 17H8"/></g></svg></span> <span data-i18n="scholarpush_title">学术快报 - 每日精选论文推荐</span></h1>
  <p class="subtitle" data-i18n="scholarpush_subtitle">每日自动精选最新论文，服务于研究者、开发者与技术爱好者</p>
      </div>
    </section>

    <section class="section" id="sp">
      <div class="container sp-one">
        <div class="sp-section">
          <h2 style="margin:0 0 4px 0" data-i18n="module_scholarpush_title">学术快报</h2>
          <p id="sp-sub" class="muted" style="margin:0 0 10px 0">—</p>
          <div class="card sp-card sp-toolbar">
            <!-- removed budget selector -->
            <div id="topic-chips" class="sp-chiprow" role="toolbar" aria-label="Topics"></div>
            <span style="flex:1 1 auto"></span>
            <input id="q" class="input" data-i18n-placeholder="search_placeholder" placeholder="搜索标题/要点/标签…" style="min-width:220px;height:36px;padding:6px 10px">
            <div style="display:flex;gap:6px;align-items:center">
              <button id="prev-day" class="btn outline small" title="Prev day" aria-label="Previous day">◀</button>
              <input id="date-picker" type="date" class="input" style="height:36px" />
              <button id="next-day" class="btn outline small" title="Next day" aria-label="Next day">▶</button>
            </div>
          </div>
        </div>

        <div class="sp-section">
          <h3 style="margin:0 0 8px 0" data-i18n="sp_overview">概览（5 分钟）</h3>
          <div id="stats" class="stat-grid"></div>
        </div>

        <div class="sp-section">
          <h3 style="margin:0 0 8px 0" data-i18n="sp_must_read">必读（15 分钟）</h3>
          <div id="must" class="sp-list"></div>
        </div>

        <div class="sp-section">
          <h3 style="margin:0 0 8px 0" data-i18n="sp_nice_read">扩展阅读（10 分钟）</h3>
          <div id="nice" class="sp-list"></div>
        </div>

        <div class="sp-section" id="deep" hidden>
          <h3 style="margin:0 0 8px 0" data-i18n="sp_deep_dive">主题深读</h3>
          <div id="deep-card" class="card sp-card"></div>
        </div>
      </div>
    </section>
  </main>

  <footer>
    <div class="container">
      <p>© <span id="year"></span> Fan Wan</p>
    </div>
  </footer>

  <script>
  (function(){
    const qInput = document.getElementById('q');
    const chipRow = document.getElementById('topic-chips');
    const statsEl = document.getElementById('stats');
    const mustEl = document.getElementById('must');
    const niceEl = document.getElementById('nice');
    const deepWrap = document.getElementById('deep');
    const deepCard = document.getElementById('deep-card');
    const subEl = document.getElementById('sp-sub');
  // budget selector removed

  let data = null;
  let items = [];
    let activeTags = new Set();
    let query = '';
  let searchTid = null;
  let searchBound = false;

    // Canonical categories to surface first in the chips bar
    const CANONICAL = [
      'LLM','RAG','Agent','NLP','CV','ASR','MM','IR','Robotics','Theory','Infra',
      'Dataset','Benchmark','Blog','Policy','Code'
    ];
    // Simple synonym map for category matching
    const SYN = {
      llm:['llm','large language model','foundation model','language model'],
      rag:['rag','retrieval','retrieval-augmented','retrieval augmented'],
      agent:['agent','tool','planner'],
      nlp:['nlp','language'],
      cv:['cv','vision','image'],
      asr:['asr','speech'],
      mm:['mm','multimodal','multi-modal'],
      ir:['ir','retrieval','information retrieval','search'],
      robotics:['robotics','robot','manipulation'],
      theory:['theory','theoretical'],
      infra:['infra','infrastructure','system','systems','engineering'],
      dataset:['dataset','data'],
      benchmark:['benchmark','evaluation','eval'],
      blog:['blog','news','announcement'],
      policy:['policy','ethics','governance'],
      code:['code','implementation','repo','github']
    };
    function norm(s){ return String(s||'').trim().toLowerCase(); }
    function hasAny(hay, arr){ const H = norm(hay); return arr.some(x=>H.includes(x)); }
    function itemMatchesCategory(it, cat){
      const k = norm(cat);
      const tTask = norm(it.task);
      const tType = norm(it.type);
      const tagsL = (it.tags||[]).map(norm);
      const syn = SYN[k]||[k];
      // Task match
      if (syn.includes(tTask)) return true;
      // Type-based categories
      if ((k==='dataset'&&tType==='dataset') || (k==='benchmark'&&tType==='benchmark') || (k==='blog'&&tType==='blog') || (k==='policy'&&tType==='policy') || (k==='code'&&tType==='code')) return true;
      // Tag synonyms
      if (tagsL.some(tag => syn.includes(tag) || hasAny(tag, syn))) return true;
      return false;
    }
    function itemMatchesTag(it, tag){
      const k = norm(tag);
      // Canonical category?
      if (CANONICAL.map(norm).includes(k)) return itemMatchesCategory(it, tag);
      // Otherwise, treat as literal tag or type or task
      const tagsL = (it.tags||[]).map(norm);
      if (tagsL.includes(k)) return true;
      if (norm(it.task)===k) return true;
      if (norm(it.type)===k) return true;
      return false;
    }
    function aggregateCounts(arr){
      const counts = new Map();
      const seenCanon = new Set();
      // Count canonical first
      for(const cat of CANONICAL){
        let c=0; for(const it of arr){ if(itemMatchesCategory(it, cat)) c++; }
        if (c>0){ counts.set(cat, c); seenCanon.add(norm(cat)); }
      }
      // Dynamic tags from items.tags
      const tagCounts = new Map();
      for(const it of arr){
        for(const t of (it.tags||[])){
          const key = String(t||'').trim(); if(!key || key.toUpperCase()==='N/A') continue;
          const kNorm = norm(key);
          // skip tags that are synonyms of canonical to avoid duplicates
          const isCanon = CANONICAL.some(c=>{ const cn=norm(c); return kNorm===cn || (SYN[cn]&&SYN[cn].includes(kNorm)); });
          if (isCanon) continue;
          tagCounts.set(key, (tagCounts.get(key)||0) + 1);
        }
      }
      // Pick top-N dynamic tags by frequency
      const extras = [...tagCounts.entries()].sort((a,b)=>b[1]-a[1]).slice(0, 10);
      for(const [k,v] of extras){ counts.set(k, v); }
      return counts;
    }

    function btn(href,label){ return `<a class="btn outline small" target="_blank" rel="noopener" href="${href}">${label}</a>` }
    // Build a map of ref url -> title for client-side healing of truncated headlines
    let refTitleByUrl = new Map();
    // basic HTML escaper for safe attribute/text injection
    function esc(s){
      return String(s||'')
        .replace(/&/g,'&amp;')
        .replace(/</g,'&lt;')
        .replace(/>/g,'&gt;')
        .replace(/"/g,'&quot;');
    }
    function arxivPdfFrom(u){
      try{ const m = String(u||'').match(/arxiv\.org\/(?:abs|pdf|html)\/(\d{4}\.\d{4,5})(?:v\d+)?/i); return m?`https://arxiv.org/pdf/${m[1]}.pdf`:''; }catch{ return ''; }
    }
    function bestSourceHref(it){
      const links = it.links||{};
      if(links.paper && links.paper!=='N/A') return links.paper;
      if(links.project && links.project!=='N/A') return links.project;
      if(links.code && links.code!=='N/A') return links.code;
      // try to infer from refs by title containment or token overlap
      const title = (displayTitle(it)||'').toLowerCase();
      const one = String(it.one_liner||'').toLowerCase();
      const quick = String(it.quick_read||'').toLowerCase();
      const candText = [title, one, quick].filter(Boolean);
      let best = {score:0, url:''};
      try{
        for(const [url, refTitle] of refTitleByUrl.entries()){
          const rt = String(refTitle||'').toLowerCase();
          let score = 0;
          if(rt && title && (rt.includes(title) || title.includes(rt))) score = 3;
          else{
            const blob = `${rt}`;
            for(const t of candText){
              if(!t) continue;
              const tokens = t.split(/[^\w\u4e00-\u9fff]+/).filter(w=>w.length>=3);
              let hits = 0; for(const w of tokens){ if(blob.includes(w)) hits++; }
              score = Math.max(score, hits);
            }
          }
          if(score>best.score) best = {score, url};
        }
      }catch{}
      return best.score>=2 ? best.url : '';
    }
    function niceHeadline(it){
      let h = String(it.headline||'').trim();
      // Try to heal truncated headlines using refs by URL
      const url = (it.links&& (it.links.paper||it.links.project)) || '';
      if(url && refTitleByUrl.has(url)){
        const ref = String(refTitleByUrl.get(url)||'').trim();
        const task = it.task || '';
        const prefix = task ? `[${task}] ` : '';
        // strip task prefix from current headline for comparison
        const base = h.replace(/^\[[^\]]+\]\s*/, '').trim();
        const baseTrim = base.replace(/[\s\-–:]+$/, ''); // drop trailing cut markers
        const looksCut = h.endsWith('-') || h.endsWith(':') || /\s$/.test(h);
        // If ref clearly starts with our base (or we see cut markers), trust ref title
        if(ref && (looksCut || (baseTrim.length>6 && ref.toLowerCase().startsWith(baseTrim.toLowerCase())))){
          return prefix + ref;
        }
      }
      return h;
    }
    function displayTitle(it){
      const lang = document.documentElement.lang || 'zh';
      const zh = (it.title_i18n && it.title_i18n.zh) ? it.title_i18n.zh : (it.headline||'');
      const en = (it.title_i18n && it.title_i18n.en) ? it.title_i18n.en : (it.headline||'');
      let t = (lang==='zh') ? (zh||niceHeadline(it)) : (en||niceHeadline(it));
      if(lang!=='zh' && it.task && !/^\[[^\]]+\]/.test(t)){
        t = `[${it.task}] ` + t;
      }
      return t;
    }
    function relTime(iso){
      try{
        if(!iso) return '';
        const d = new Date(iso);
        const s = Math.max(0, (Date.now()-d.getTime())/1000);
        if(s<60) return 'just now';
        if(s<3600) return Math.floor(s/60)+'m ago';
        if(s<86400) return Math.floor(s/3600)+'h ago';
        return Math.floor(s/86400)+'d ago';
      }catch(e){return ''}
    }
    function card(it){
  const tags=(it.tags||[]).filter(t=>t && t!=='N/A').map(t=>`<span class="tag">${t}</span>`).join(' ');
  const links=it.links||{}; const id=Math.random().toString(36).slice(2);
      const keynumsCompact=(it.key_numbers_compact||[])
        .map(s=>String(s||''))
        .map(s=>s.split(/\s+/).filter(x=>x && x.toUpperCase()!=='N/A').join(' '))
        .filter(s=>s && s.toUpperCase()!=='N/A')
        .slice(0,3)
        .map(s=>`<span class="tag small">${esc(s)}</span>`)
        .join(' ');
      const codeBadge = it.has_code ? `<span class="tag small" title="has code">code</span>` : '';
  const utils=(it.reusability||[]).filter(x=>x && x!=='N/A').slice(0,3).map(x=>`<li>${esc(x)}</li>`).join('');
  const limits=(it.limitations||[]).filter(x=>x && x!=='N/A').slice(0,2).map(x=>`<li>${esc(x)}</li>`).join('');
  const labelReu = t('sp_reusability', (document.documentElement.lang||'zh')==='zh'?'可复用':'Reusability');
  const labelLim = t('sp_limitations', (document.documentElement.lang||'zh')==='zh'?'局限':'Limitations');
      const host = it.host||'';
      const tsRel = relTime(it.ts||'');
      const meta=[it.task||'',it.type||'',host,tsRel].filter(Boolean).join(' · ');
  const isZH = (document.documentElement.lang||'zh')==='zh';
  // Prefer full English abstract for EN; avoid truncation here
  const fullTxt  = isZH
      ? String(it.summary_i18n?.zh || it.one_liner || it.quick_read || '')
      : String(it.summary_i18n?.en || it.one_liner || it.quick_read || '');
  // no short/expand; always render full text
      const titleHtml = esc(displayTitle(it));
  // Resolve a primary source link with refs fallback
  let sourceHref = bestSourceHref(it);
  // Derive a PDF if none and arXiv
  let pdfHref = (links.pdf && links.pdf!=='N/A') ? links.pdf : arxivPdfFrom(sourceHref);
    return `<article class="card sp-card">
        <h4 class="sp-title" style="display:-webkit-box;-webkit-line-clamp:3;line-clamp:3;-webkit-box-orient:vertical;overflow:hidden">${titleHtml}</h4>
        <div class="sp-meta">${meta}${tags?` · ${tags}`:''} ${keynumsCompact?` · ${keynumsCompact}`:''} ${codeBadge}</div>
    <p id="abs-${id}" class="sp-abstract">${esc(fullTxt)}</p>
  ${(utils||limits)?
    `<div style="display:flex;gap:12px;margin-top:6px">
      ${utils?`<div><div class="muted" style="font-size:12px;margin-bottom:2px">${labelReu}</div><ul class="muted" style="margin:0;list-style:none;padding-left:0">${utils}</ul></div>`:''}
      ${limits?`<div><div class="muted" style="font-size:12px;margin-bottom:2px">${labelLim}</div><ul class="muted" style="margin:0;list-style:none;padding-left:0">${limits}</ul></div>`:''}
    </div>`
  :''}
        <div style="display:flex;gap:6px;flex-wrap:wrap;margin-top:8px">
          ${sourceHref?btn(sourceHref,'Source Link'):''}
          ${links.code&&links.code!=='N/A'?btn(links.code,'Code'):''}
          ${pdfHref?btn(pdfHref,'PDF'):''}
          ${links.project&&links.project!=='N/A'?btn(links.project,'Project'):''}
        </div>
      </article>`;
    }
  function t(key, fallback){ try { const lang = localStorage.getItem('lang')||document.documentElement.lang||'zh'; const tx=(window.translations?.[lang]?.[key]); return tx||fallback||key; } catch { return fallback||key; } }
  function statCard(title,val){ return `<div class="card sp-card"><div class="muted">${title}</div><div style="font-weight:600;font-size:18px">${val}</div></div>` }
    function renderStats(stats){
      let byTask=stats.by_task||{};
      let sum=Object.values(byTask).reduce((a,b)=>a+b,0);
      // Fallback: build from items when feed stats are empty
      if (!sum && Array.isArray(items) && items.length){
        const tmp = {};
        for(const it of items){ const k = it.task||'Other'; tmp[k] = (tmp[k]||0)+1; }
        byTask = tmp; sum = items.length;
      }
      const top=Object.entries(byTask).sort((a,b)=>b[1]-a[1]).slice(0,4);
      statsEl.innerHTML = [
        statCard(t('sp_stat_total','总条目'), sum),
        statCard(t('sp_stat_code','含代码'), stats.with_code||0),
        statCard(t('sp_stat_bench','新基准/数据'), stats.new_benchmarks||0),
        statCard(t('sp_stat_top_tasks','Top 任务'), top.map(([k,v])=>`${k}:${v}`).join(' · ')||'—')
      ].join('');
    }
    function buildChips(){
      chipRow.innerHTML='';
      const counts = aggregateCounts(items||[]);
      // ALL button
      const allBtn=document.createElement('button');
      allBtn.className='btn outline small'+(activeTags.size===0?' primary':'');
      allBtn.textContent=t('all_label','全部');
      allBtn.onclick=()=>{activeTags.clear(); renderAll();};
      chipRow.appendChild(allBtn);
      // Canonical first (only those with counts)
      for(const cat of CANONICAL){
        if(!counts.has(cat)) continue;
        const n = counts.get(cat)||0; const act = activeTags.has(cat);
        const b=document.createElement('button');
        b.className='btn outline small'+(act?' primary':'');
        b.textContent=`${cat} · ${n}`;
        b.onclick=()=>{ act?activeTags.delete(cat):activeTags.add(cat); renderAll(); };
        chipRow.appendChild(b);
      }
      // Dynamic extras (top-N from counts that are not canonical)
      const canonSet = new Set(CANONICAL.map(norm));
      const extras = [...counts.entries()].filter(([k])=>!canonSet.has(norm(k))).sort((a,b)=>b[1]-a[1]).slice(0, 10);
      for(const [tag, n] of extras){
        const act = activeTags.has(tag);
        const b=document.createElement('button');
        b.className='btn outline small'+(act?' primary':'');
        b.textContent=`${tag} · ${n}`;
        b.onclick=()=>{ act?activeTags.delete(tag):activeTags.add(tag); renderAll(); };
        chipRow.appendChild(b);
      }
    }
  function filterItems(arr){
      const qs=(query||'').trim().toLowerCase();
      return arr.filter(it=>{
        if(activeTags.size>0){
          let ok=false; for(const tag of activeTags){ if(itemMatchesTag(it, tag)) { ok=true; break; } }
          if(!ok) return false;
        }
        if(!qs) return true;
    const blob = `${it.headline||''} ${it.one_liner||''} ${it.title_i18n?.zh||''} ${it.title_i18n?.en||''} ${it.summary_i18n?.zh||''} ${it.summary_i18n?.en||''} ${it.host||''} ${(it.tags||[]).join(' ')}`.toLowerCase();
        return qs.split(/\s+/).filter(Boolean).some(w=>blob.includes(w));
      });
    }
    function renderAll(){
      // subtitle
  const dt=data?.generated_at||''; const lang = localStorage.getItem('lang')||document.documentElement.lang||'zh';
  if (lang==='en') subEl.textContent = `Today ${data?.items?.length||0} · Generated at ${dt.slice(0,16).replace('T',' ')}`;
  else if (lang==='es') subEl.textContent = `Hoy ${data?.items?.length||0} · Generado a las ${dt.slice(0,16).replace('T',' ')}`;
  else subEl.textContent = `今日 ${data?.items?.length||0} 条 · 生成时间 ${dt.slice(0,16).replace('T',' ')}`;
      // chips + stats
      buildChips(); renderStats(data?.stats||{by_task:{},with_code:0,new_benchmarks:0});
      // lists
      const src=items.slice();
      const mustIdx=(data?.must_reads||[]).filter(i=>i<src.length);
      const niceIdx=(data?.nice_to_read||[]).filter(i=>i<src.length);
      const mustList = filterItems(mustIdx.map(i=>src[i]));
      const niceList = filterItems(niceIdx.map(i=>src[i]));
      mustEl.innerHTML = mustList.map(card).join('');
      niceEl.innerHTML = niceList.map(card).join('');
      // deep
      const dd=data?.deep_dive; 
      const ddTitle = (dd&&dd.title&&String(dd.title).trim().toUpperCase()!=='N/A') ? String(dd.title).trim() : '';
      const ddSummary = (dd&&dd.summary&&String(dd.summary).trim().toUpperCase()!=='N/A') ? String(dd.summary).trim() : '';
      const refIdx = Array.isArray(dd?.refs)? dd.refs.filter(i=>Number.isInteger(i)&&i>=0&&i<items.length) : [];
      deepWrap.hidden = !(dd && (ddTitle || ddSummary || refIdx.length));
      if(!deepWrap.hidden){
        let html = '';
        if(ddTitle) html += `<h4 style="margin:0 0 6px 0">${esc(ddTitle)}</h4>`;
        if(ddSummary) html += `<p class="muted" style="margin:0 0 8px 0">${esc(ddSummary)}</p>`;
        if(refIdx.length){
          const related = refIdx.map(i=>{
            const it = items[i]||{}; const links = it.links||{};
            const title = esc(displayTitle(it));
            const isZH = (document.documentElement.lang||'zh')==='zh';
            const summary = isZH ? String(it.summary_i18n?.zh || it.one_liner || it.quick_read || '')
                                 : String(it.summary_i18n?.en || it.one_liner || it.quick_read || '');
            const tags = (it.tags||[]).filter(t=>t && t!=='N/A').slice(0,4).map(t=>`<span class="tag small">${esc(t)}</span>`).join(' ');
            const sourceHref = bestSourceHref(it);
            const pdfHref = (links.pdf && links.pdf!=='N/A') ? links.pdf : arxivPdfFrom(sourceHref);
            const btnsArr = [
              sourceHref?btn(sourceHref,'Source Link'):'',
              (links.code&&links.code!=='N/A')?btn(links.code,'Code'):'',
              (pdfHref)?btn(pdfHref,'PDF'):'',
            ].filter(Boolean);
            const btns = btnsArr.join(' ');
            return `<div class="card sp-card" style="padding:8px 10px">
              <div style="font-weight:600;margin-bottom:4px">${title}</div>
              ${tags?`<div class="muted" style="margin:0 0 6px 0;display:flex;gap:6px;flex-wrap:wrap">${tags}</div>`:''}
              ${summary?`<p class="muted" style="margin:0 0 6px 0">${esc(summary)}</p>`:''}
              ${btns?`<div style="display:flex;gap:6px;flex-wrap:wrap">${btns}</div>`:''}
            </div>`;
          }).join('');
          html += `<div style="display:flex;flex-direction:column;gap:8px">${related}</div>`;
        }
        deepCard.innerHTML = html;
      }
    }
  async function loadByDate(dateStr){
      let path = '../data/ai/scholarpush/index.json';
      if(dateStr) path = `../data/ai/scholarpush/${dateStr}.json`;
      const sp = await fetch(path, {cache:'no-store'}).then(r=>r.json()).catch(()=>null);
      data = sp||{}; items = Array.isArray(sp?.items)? sp.items: [];
      // normalize pdf links if missing
      items.forEach(it=>{ if(!it.links) it.links={}; if(!it.links.pdf && it.links.paper){ const m=(it.links.paper||'').match(/\d{4}\.\d{4,5}/); if(m) it.links.pdf = `https://arxiv.org/pdf/${m[0]}.pdf`; }});
      // cache refs for headline healing
      try { refTitleByUrl = new Map((sp?.refs||[]).map(r=>[r.url, r.title])); } catch(e) { refTitleByUrl = new Map(); }
  // no expand/collapse; abstracts are fully shown
  renderAll();
  }
  async function init(){
      // bind search once
      if(!searchBound){
        qInput.addEventListener('input', ()=>{ clearTimeout(searchTid); searchTid=setTimeout(()=>{ query=qInput.value||''; renderAll(); }, 200); });
        searchBound = true;
      }
      // load available dates
      let dates=[]; try{ dates = await fetch('../data/ai/scholarpush/dates.json', {cache:'no-store'}).then(r=>r.json()); }catch(e){ dates=[]; }
      const dp = document.getElementById('date-picker');
      // set date picker bounds
      if(dates.length>0){ dp.min = dates[dates.length-1]; dp.max = dates[0]; }
      // default to first option (most recent)
      if(dates.length>0){ dp.value = dates[0]; }
      await loadByDate(dp.value||'');
      // hook prev/next
      const prevBtn=document.getElementById('prev-day');
      const nextBtn=document.getElementById('next-day');
      function updateNav(){
        const idx = dates.indexOf(dp.value||'');
        prevBtn.disabled = (idx===-1) || (idx>=dates.length-1);
        nextBtn.disabled = (idx===-1) || (idx<=0);
      }
      updateNav();
      dp.onchange = async ()=>{
        const chosen = dp.value;
        if(!chosen){ return; }
        // pick exact match or nearest earlier date
        let idx = dates.indexOf(chosen);
        if(idx === -1){
          idx = dates.findIndex(d=>d <= chosen);
          if(idx === -1) idx = dates.length-1;
        }
        dp.value = dates[idx];
        await loadByDate(dp.value);
        updateNav();
      };
      prevBtn.onclick = async ()=>{ const i=dates.indexOf(dp.value||''); if(i<dates.length-1 && i>=0){ dp.value=dates[i+1]; await loadByDate(dp.value); updateNav(); } };
      nextBtn.onclick = async ()=>{ const i=dates.indexOf(dp.value||''); if(i>0){ dp.value=dates[i-1]; await loadByDate(dp.value); updateNav(); } };
      // Re-render content on language change
      window.addEventListener('language-changed', () => { renderAll(); });
    }
    init();
  })();
  </script>
</body>
</html>
